# 직렬화
- 자바 직렬화란 자바 시스템 내부에서 사용되는 객체 또는 데이터를 외부의 자바 시스템에서도 사용할 수 있도록 바이트(byte)
- 형태로 데이터 변환하는 기술과 바이트로 변환된 데이터를 다시 객체로 변환하는 기술(역직렬화)을 아울러서 말함
- 시스템적으로 이야기하자면 JVM(Java Virtual Mchine 이하 JVM)의 메모리에 상주(힙 또는 스택)되어 있는 객체 데이터를
- 바이트 형태로 변환하는 기술과 직렬화된 바이트 형태의 데이터를 객체로 변환해서 JVM으로 상주시키는 형태를 같이 말함

## How?
- 자바 직렬화 조건
  - 자바 기본(primitive)타입과 java.io.Serializable 인터페이스를 상속받은 객체는 직렬화 할 수 있는 기본 조건을 가진다.

```java
package com.example.test.prac;

import org.junit.Test;
import org.junit.jupiter.api.DisplayName;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;
import java.util.Base64;

import static com.sun.java.util.jar.pack.Utils.log;

public class SerializeTest {
    @Test
    @DisplayName("Serialize Test")
    public void SerializeTest() {
        User user = User.builder()
                .name("Happykoo")
                .age(30)
                .email("rudals4549@gmail.com")
                .build();

        String serializedUserBase64;

        try(ByteArrayOutputStream baos = new ByteArrayOutputStream()) {
            try(ObjectOutputStream oos = new ObjectOutputStream(baos)) {
                oos.writeObject(user);
                //직렬화(byte array)
                byte[] serializedUser = baos.toByteArray();
                //byte array를 base64로 변환
                serializedUserBase64 = Base64.getEncoder().encodeToString(serializedUser);
                log.debug("serializedUserBase64 >> {}", serializedUserBase64);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}


//결과
serializedUserBase64 >> rO0ABXNyABduZXQuaGFwcHlrb28ubW9kZWwuVXNlcqLhsk0TYPUEAgADSQADYWdlTAAFZW1haWx0ABJMamF2YS9sYW5nL1N0cmluZztMAARuYW1lcQB+AAF4cAAAAB50ABRydWRhbHM0NTQ5QGdtYWlsLmNvbXQACEhhcHB5a29

```

- 역 직렬화
```java
@Slf4j
public class SerializeTest {
    ...

    @Test
    @DisplayName("Deserialize Test")
    public void DeserializeTest() {
        String serializedUserBase64 = "rO0ABXNyABduZXQuaGFwcHlrb28ubW9kZWwuVXNlcqLhsk0TYPUEAgADSQADYWdlTAAFZW1haWx0ABJMamF2YS9sYW5nL1N0cmluZztMAARuYW1lcQB+AAF4cAAAAB50ABRydWRhbHM0NTQ5QGdtYWlsLmNvbXQACEhhcHB5a29v";
        byte[] serializedUser = Base64.getDecoder().decode(serializedUserBase64);

        try(ByteArrayInputStream bais = new ByteArrayInputStream(serializedUser)) {
            try(ObjectInputStream ois = new ObjectInputStream(bais)) {
                //역직렬화(byte array -> object)
                Object objectUser = ois.readObject();
                User user = (User) objectUser;
                log.debug(user.toString());
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}

// 결과
// User name: Happykoo, age: 30, email: rudals4549@gmail.com
```


출처 : https://techblog.woowahan.com/2550/
